/*
*	Author:       xzy
**	Created:      2019/7/22 21:38:17
*   Description:  发送邮件相关
 */
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Net.Mail;
using VMCloud.Models;
using System.Configuration;
using VMCloud.Utils;
using VMCloud.Models.DAO;
using System.Text;
namespace VMCloud.Utils
{
    public class EmailUtil
    {
        public static string SendEmail(string emailmain, string emailContent, string userid, int hasHref = 0, string href = "")
        {
            try
            {
                string smtpServer = ConfigurationManager.AppSettings["smtpServer"];
                string mailFrom = ConfigurationManager.AppSettings["EmailAccount"];
                string userPassword = ConfigurationManager.AppSettings["EmailPassword"];

                SmtpClient smtpClient = new SmtpClient();
                smtpClient.DeliveryMethod = SmtpDeliveryMethod.Network;//指定电子邮件发送方式
                smtpClient.Host = smtpServer; //指定SMTP服务器
                smtpClient.Credentials = new System.Net.NetworkCredential(mailFrom, userPassword);

                //smtpClient.EnableSsl = true;
                smtpClient.Port = 25;
                //string imagesrc = "";
                string Toemail = "";
                User user = UserDao.GetUserById(userid);
                Toemail = user.email;
                if (Toemail == "")
                {
                    return "fail";
                }
                string username = user.name;
                string imagesrc = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaEAAABSCAIAAAByu/yWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGwWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDMtMTlUMTc6MDI6NDArMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTAzLTE5VDE5OjM3OjE1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTAzLTE5VDE5OjM3OjE1KzA4OjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjMzZjEyMGM2LTE0ZWItMzI0NC05MGJkLTY0ZjUzMTE0MGQ3YSIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjBlYjMyOTAxLWUxODYtMDk0NC1iZWU5LTU5NDUxNzg2Y2ExZCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOkQyQjUxNDc4NTZGQTExRTdBMzU0RkNGNEI2OTk0QUU5IiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RDJCNTE0NzU1NkZBMTFFN0EzNTRGQ0Y0QjY5OTRBRTkiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RDJCNTE0NzY1NkZBMTFFN0EzNTRGQ0Y0QjY5OTRBRTkiLz4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MjdkNGM2NWItYjQxMC1mZDQyLThhNDAtOTg0NGYzYTk3MTM0IiBzdEV2dDp3aGVuPSIyMDE4LTAzLTE5VDE5OjM3OjE1KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozM2YxMjBjNi0xNGViLTMyNDQtOTBiZC02NGY1MzExNDBkN2EiIHN0RXZ0OndoZW49IjIwMTgtMDMtMTlUMTk6Mzc6MTUrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+GY2ZDAAANH5J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";
                    //Toemail = "zzw772522478@gmail.com";
                //string username = "ziyu";
                string EmailMain = emailmain;
                string EmailText = "<table align='center' border='0' cellpadding='0' cellspacing='0'style=' width:88%; margin-top:20px; margin-bottom:20px; background:#fafafa; border:1px solid #ddd;'><tbody>"
                               + "<tr>"
                                    + "<td width='24'>&nbsp;</td>"
                                    + "<td style='padding-top:16px;'><img height='50px' src='" + imagesrc + "' style='display:block; vertical-align:top;' width='250px'></td>"
                                + "</tr><tr>"
                                   + "<td width='24'>&nbsp;</td>"
                                   + "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:24px;'>" + username + " 您好：</td>"
                                   + "<td width='24'>&nbsp;</td>"
                               + "</tr><tr>"
                                   + "<td width='24'>&nbsp;</td>"
                                   + "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:18px;'>" + emailContent + "</td>"
                                   + "<td width='24'>&nbsp;</td>"
                               + "</tr>"
                                   + (hasHref == 1 ? "<tr>" : "")
                                   + (hasHref == 1 ? "<td width='24'>&nbsp;</td>" : "")
                                   + (hasHref == 1 ? "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:18px;'><a href='" + href + "' style='color:#50b7f1;text-decoration:none;font-weight:bold' target='_blank'>"+emailmain+"</a></td>" : "")
                                   + (hasHref == 1 ? "<td width='24'>&nbsp;</td>" : "")
                                   + (hasHref == 1 ? "</tr>" : "")
                                   + (hasHref == 1 ? "<tr>" : "")
                                   + (hasHref == 1 ? "<td width='24'>&nbsp;</td>" : "")
                                   + (hasHref == 1 ? "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:24px;'>如果上述链接无法点击，请复制以下链接" + href + " </td>" : "")
                                   + (hasHref == 1 ? "<td width='24'>&nbsp;</td>" : "")
                                   + (hasHref == 1 ? "</tr>" : "")
                               + "<tr>"
                                   + "<td style='padding-top:18px; padding-bottom:32px; border-bottom:1px solid #e1e1e1;' width='24'>&nbsp;</td>"
                                   + "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:18px; padding-bottom:32px; border-bottom:1px solid #e1e1e1;'>谢谢使用！<br> 北航软院云平台</td>"
                                   + "<td style='padding-top:18px; padding-bottom:32px; border-bottom:1px solid #e1e1e1;' width='24'>&nbsp;</td>"
                               + "</tr>"
                               + "<tr>"
                               + "<td width='24'>&nbsp;</td>"
                                   + "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:18px;'>您可以<a href='" + ConfigurationManager.AppSettings["MyServer"] + "' style='color:#50b7f1;text-decoration:none;font-weight:bold' target='_blank'>点击此处访问云平台</a></td>"
                                   + "<td width='24'>&nbsp;</td>"
                                   + "</tr>"
                                   + "<tr>"
                                   + "<td width='24'>&nbsp;</td>"
                                   + "<td colspan='2' style='color:#858585; font-family:Arial, Helvetica, sans-serif; font-size:14px; line-height:20px; padding-top:24px;'>如果上述链接无法点击，请复制以下链接到浏览器地址栏进行访问：" + ConfigurationManager.AppSettings["MyServer"] + " </td>"
                                   + "<td width='24'>&nbsp;</td>"
                                   + "</tr>"
                               + "</tr>"
                           + "</tbody></table>";
                MailMessage mailMessage = new MailMessage(mailFrom, Toemail);
                mailMessage.Subject = EmailMain;
                mailMessage.Body = EmailText;
                mailMessage.BodyEncoding = Encoding.UTF8;
                mailMessage.IsBodyHtml = true;
                mailMessage.Priority = MailPriority.Low;
                smtpClient.Send(mailMessage);
                return "success";
            }
            catch (SmtpException ex)
            {
                return ex.Message;
            }
        }    

    }

}
